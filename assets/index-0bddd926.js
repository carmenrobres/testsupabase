import{createClient as d}from"https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function i(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(e){if(e.ep)return;e.ep=!0;const r=i(e);fetch(e.href,r)}})();let a;const c="https://ogezfwngzpwubwypbzvq.supabase.co".trim(),l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9nZXpmd25nenB3dWJ3eXBienZxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE1MjMxODIsImV4cCI6MjA0NzA5OTE4Mn0.edFVx7jeUoldVCdl5UAsxkVHFxi733aOb1gGMMj0zY0".trim();if(!c||!l)throw new Error("Supabase environment variables are missing or invalid.");try{a=d(c,l),console.log("Supabase client initialized successfully")}catch(t){console.error("Failed to initialize Supabase client:",t)}console.log("Supabase URL:",c);console.log("Supabase Key:",l);console.log("Supabase client:",a);async function u(){try{if(!a)throw new Error("Supabase client is not initialized.");const{data:t,error:n}=await a.from("transcriptions").select("image_url, transcription, question, created_at").order("created_at",{ascending:!1});if(n){console.error("Error fetching data:",n);return}console.log("Fetched data:",t),p(t)}catch(t){console.error("Error in fetchImagesAndText:",t)}}function p(t){const n=document.getElementById("gallery");if(!n){console.error("Gallery element not found");return}n.innerHTML="",t.forEach(i=>{const s=document.createElement("div");s.className="gallery-item";const e=i.question?i.question.trim():"No question available",r=i.transcription.split(".").filter(o=>o.trim()!=="").map(o=>`<p>${o.trim()}.</p>`).join("");s.innerHTML=`
    <img src="${i.image_url}" alt="Image">
    <div class="content">
        <span class="question">${e}</span>
        ${r}
    </div>
    `,n.appendChild(s)})}function f(){try{if(!a)throw new Error("Supabase client is not initialized.");a.channel("transcriptions").on("postgres_changes",{event:"*",schema:"public",table:"transcriptions"},async()=>{console.log("Real-time update received"),await u()}).subscribe()}catch(t){console.error("Error in subscribeToUpdates:",t)}}u();f();
